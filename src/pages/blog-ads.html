<div class="container-fluid p-0">
    <!-- Header Section -->
    <div class="bg-primary text-white py-5">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb breadcrumb-dark mb-3">
                    <li class="breadcrumb-item"><a href="/" class="text-white-50">Início</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Blog</li>
                </ol>
            </nav>
            <h1 class="display-4 mb-2" id="page-title">Blog do Framework</h1>
            <p class="lead mb-0" id="page-description">Guias rápidos, changelog e dicas para tirar mais do Framework Frontend</p>
        </div>
    </div>

    <!-- Search and Filter Section -->
    <section class="search-filter py-4 bg-light">
        <div class="container-lg">
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="input-group">
                        <span class="input-group-text bg-white border-end-0">
                            <i class="bi bi-search text-muted"></i>
                        </span>
                        <input type="text" class="form-control border-start-0" id="search-input" placeholder="Buscar artigos...">
                    </div>
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="category-filter">
                        <option value="">Todas as categorias</option>
                        <option value="Arquitetura">Arquitetura</option>
                        <option value="Produtividade">Produtividade</option>
                        <option value="Performance">Performance</option>
                        <option value="Releases">Releases</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="sort-filter">
                        <option value="newest">Mais recentes</option>
                        <option value="oldest">Mais antigos</option>
                        <option value="title">Título A-Z</option>
                    </select>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container-lg py-5">
        <div class="row">
            <!-- Blog Posts Column -->
            <div class="col-lg-8">
                <!-- Ad Space 1 - Top Banner -->
                <div class="ad-container mb-4">
                    <div class="ad-label text-center text-muted mb-2">
                        <i class="bi bi-megaphone me-1"></i>Publicidade
                    </div>
                    <div class="ad-space bg-light rounded p-3 text-center" style="min-height: 90px;">
                        <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                            data-ad-slot="XXXXXXXXXX"
                            data-ad-format="auto"
                            data-full-width-responsive="true"></ins>
                    </div>
                </div>

                <!-- Blog Posts Grid -->
                <div class="row" id="blog-posts-container">
                    <!-- Blog posts will be dynamically inserted here -->
                </div>

                <!-- Pagination -->
                <nav aria-label="Blog pagination" class="mt-5">
                    <ul class="pagination justify-content-center" id="pagination">
                        <!-- Pagination will be dynamically inserted here -->
                    </ul>
                </nav>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <!-- Categories Widget -->
                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">
                            <i class="bi bi-tags me-2"></i>Categorias
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="list-group list-group-flush" id="categories-list">
                            <!-- Categories will be dynamically inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Recent Posts Widget -->
                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">
                            <i class="bi bi-clock-history me-2"></i>Posts Recentes
                        </h5>
                    </div>
                    <div class="card-body">
                        <div id="recent-posts-list">
                            <!-- Recent posts will be dynamically inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Ad Space 2 - Sidebar -->
                <div class="ad-container mb-4">
                    <div class="ad-label text-center text-muted mb-2">
                        <i class="bi bi-megaphone me-1"></i>Publicidade
                    </div>
                    <div class="ad-space bg-light rounded p-3 text-center" style="min-height: 600px;">
                        <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                            data-ad-slot="XXXXXXXXXX"
                            data-ad-format="vertical"
                            data-full-width-responsive="true"></ins>
                    </div>
                </div>

                <!-- Newsletter Signup -->
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0">
                            <i class="bi bi-envelope me-2"></i>Newsletter
                        </h5>
                    </div>
                    <div class="card-body">
                        <p class="text-muted small">Receba lançamentos, tutoriais e hacks diretamente no seu e-mail</p>
                        <div class="input-group mb-3">
                            <input type="email" class="form-control" placeholder="Seu e-mail">
                            <button class="btn btn-outline-info" type="button">
                                <i class="bi bi-send"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* Ad Styles */
.ad-label {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
}

.ad-space {
    border: 2px dashed #dee2e6;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.ad-space:hover {
    border-color: #adb5bd;
    background-color: #f8f9fa;
}

/* Blog Post Cards */
.blog-post-card {
    transition: all 0.3s ease;
    height: 100%;
    border: none;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    overflow: hidden;
}

.blog-post-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.blog-post-image {
    height: 220px;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.blog-post-card:hover .blog-post-image {
    transform: scale(1.05);
}

.blog-post-content {
    padding: 1.5rem;
}

.blog-post-title {
    font-size: 1.25rem;
    margin-bottom: 0.75rem;
    line-height: 1.4;
    color: #2c3e50;
}

.blog-post-excerpt {
    color: #6c757d;
    font-size: 0.95rem;
    line-height: 1.6;
    margin-bottom: 1rem;
}

.blog-post-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.blog-post-category {
    font-size: 0.8rem;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-weight: 600;
}

.blog-post-date {
    font-size: 0.85rem;
    color: #6c757d;
}

.blog-post-tags {
    margin-top: 1rem;
}

.blog-post-tag {
    display: inline-block;
    font-size: 0.75rem;
    padding: 0.2rem 0.6rem;
    margin: 0.1rem;
    background-color: #f8f9fa;
    color: #495057;
    border-radius: 15px;
    text-decoration: none;
    transition: all 0.2s ease;
}

.blog-post-tag:hover {
    background-color: #e9ecef;
    color: #212529;
    text-decoration: none;
}

/* Search and Filter */
.search-filter {
    border-bottom: 1px solid #dee2e6;
}

.input-group-text {
    border-right: none;
}

.form-control:focus {
    border-color: #0d6efd;
    box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
}

/* Sidebar Widgets */
.card-header {
    border-bottom: none;
    font-weight: 600;
}

.list-group-item {
    border: none;
    padding: 0.75rem 0;
    color: #495057;
    transition: all 0.2s ease;
}

.list-group-item:hover {
    color: #0d6efd;
    background-color: transparent;
    padding-left: 0.5rem;
}

.list-group-item.active {
    background-color: #0d6efd;
    border-color: #0d6efd;
}

/* Recent Posts */
.recent-post-item {
    display: flex;
    align-items: start;
    padding: 0.75rem 0;
    border-bottom: 1px solid #f1f3f4;
    text-decoration: none;
    color: inherit;
    transition: all 0.2s ease;
}

.recent-post-item:hover {
    color: #0d6efd;
    text-decoration: none;
}

.recent-post-item:last-child {
    border-bottom: none;
}

.recent-post-image {
    width: 60px;
    height: 60px;
    object-fit: cover;
    border-radius: 8px;
    margin-right: 1rem;
    flex-shrink: 0;
}

.recent-post-content h6 {
    font-size: 0.9rem;
    margin-bottom: 0.25rem;
    line-height: 1.3;
}

.recent-post-date {
    font-size: 0.75rem;
    color: #6c757d;
}

/* Pagination */
.pagination .page-link {
    border: none;
    color: #6c757d;
    padding: 0.75rem 1rem;
    margin: 0 0.25rem;
    border-radius: 8px;
    transition: all 0.2s ease;
}

.pagination .page-link:hover {
    background-color: #e9ecef;
    color: #495057;
}

.pagination .page-item.active .page-link {
    background-color: #0d6efd;
    border-color: #0d6efd;
}

/* Breadcrumb */
.breadcrumb-item + .breadcrumb-item::before {
    color: rgba(255, 255, 255, 0.5);
}

.breadcrumb-item a {
    text-decoration: none;
}

.breadcrumb-item a:hover {
    text-decoration: underline;
}

/* Responsive */
@media (max-width: 991.98px) {
    .blog-post-image {
        height: 180px;
    }
    
    .blog-post-content {
        padding: 1rem;
    }
    
    .blog-post-title {
        font-size: 1.1rem;
    }
}

@media (max-width: 767.98px) {
    .search-filter .col-md-3 {
        margin-top: 1rem;
    }
    
    .blog-post-meta {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
}
</style>

<script type="module">
import blogPosts from '/src/data/blog-posts.js';

const BLOG_CONFIG = {
    postsPerPage: 6,
    currentPage: 1,
    searchTerm: '',
    selectedCategory: '',
    sortBy: 'newest',
    allPosts: []
};

const slugify = (value = '') => {
    if (window.core?.helpers?.slugify) {
        return window.core.helpers.slugify(value);
    }
    return value
        .toString()
        .toLowerCase()
        .trim()
        .replace(/[^a-z0-9]+/g, '-')
        .replace(/(^-|-$)/g, '');
};

(function initAds() {
    const script = document.createElement('script');
    script.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js';
    script.async = true;
    document.head.appendChild(script);
    (adsbygoogle = window.adsbygoogle || []).push({});
})();

function bootstrapBlog() {
    const title = document.getElementById('page-title');
    const desc = document.getElementById('page-description');
    if (title) title.textContent = 'Blog do Framework';
    if (desc) desc.textContent = 'Guias rápidos, changelog e dicas para tirar mais do Framework Frontend';

    BLOG_CONFIG.allPosts = blogPosts;
    renderBlogPosts(blogPosts);
    renderCategories(blogPosts);
    renderRecentPosts(blogPosts.slice(0, 5));
}

function filterAndSortPosts() {
    let filteredPosts = [...BLOG_CONFIG.allPosts];

    if (BLOG_CONFIG.searchTerm) {
        const searchLower = BLOG_CONFIG.searchTerm.toLowerCase();
        filteredPosts = filteredPosts.filter(post =>
            post.title.toLowerCase().includes(searchLower) ||
            (post.excerpt && post.excerpt.toLowerCase().includes(searchLower)) ||
            (post.category && post.category.toLowerCase().includes(searchLower))
        );
    }

    if (BLOG_CONFIG.selectedCategory) {
        filteredPosts = filteredPosts.filter(post => post.category === BLOG_CONFIG.selectedCategory);
    }

    switch (BLOG_CONFIG.sortBy) {
        case 'oldest':
            filteredPosts.sort((a, b) => new Date(a.date || a.publishedAt) - new Date(b.date || b.publishedAt));
            break;
        case 'title':
            filteredPosts.sort((a, b) => a.title.localeCompare(b.title));
            break;
        case 'newest':
        default:
            filteredPosts.sort((a, b) => new Date(b.date || b.publishedAt) - new Date(a.date || a.publishedAt));
            break;
    }

    return filteredPosts;
}

function renderBlogPosts(posts) {
    if (posts.length === 0) {
        const emptyState = `
            <div class="col-12">
                <div class="text-center py-5">
                    <i class="bi bi-search display-1 text-muted"></i>
                    <h3 class="mt-3">Nenhum artigo encontrado</h3>
                    <p class="text-muted">Tente ajustar os filtros de busca</p>
                </div>
            </div>
        `;
        window.core.setData('blog-posts-container', emptyState);
        return;
    }

    const html = posts.map(item => {
        const imageUrl = item?.image;
        const imageAlt = item?.title;
        const publishedDate = new Date(item.date || item.publishedAt).toLocaleDateString('pt-BR', {
            day: '2-digit',
            month: 'short',
            year: 'numeric'
        });

        return `
            <div class="col-md-6 col-lg-4 mb-4">
                <a href="/blog-review/${item?.id}/${slugify(item?.title)}" class="text-decoration-none">
                    <div class="card blog-post-card">
                        ${imageUrl ? `
                            <img src="${imageUrl}" class="blog-post-image" alt="${imageAlt}">
                        ` : `
                            <div class="blog-post-image bg-light d-flex align-items-center justify-content-center">
                                <i class="bi bi-image text-muted" style="font-size: 3rem;"></i>
                            </div>
                        `}
                        <div class="blog-post-content">
                            <div class="blog-post-meta">
                                <span class="blog-post-category bg-primary text-white">${item?.category || 'Geral'}</span>
                                <span class="blog-post-date">
                                    <i class="bi bi-calendar3 me-1"></i>${publishedDate}
                                </span>
                            </div>
                            <h3 class="blog-post-title">${item?.title}</h3>
                            <p class="blog-post-excerpt">${item?.excerpt || ''}</p>
                        </div>
                    </div>
                </a>
            </div>
        `;
    }).join('');

    window.core.setData('blog-posts-container', html);
}

function renderCategories(posts) {
    const categories = [...new Set(posts.map(post => post.category || 'Geral'))];
    const categoryCounts = {};

    posts.forEach(post => {
        const category = post.category || 'Geral';
        categoryCounts[category] = (categoryCounts[category] || 0) + 1;
    });

    const html = categories.map(category => `
        <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center category-item" data-category="${category}">
            ${category}
            <span class="badge bg-primary rounded-pill">${categoryCounts[category]}</span>
        </a>
    `).join('');

    window.core.setData('categories-list', html);
}

function renderRecentPosts(posts) {
    const html = posts.map(post => {
        const imageUrl = post?.image;
        const imageAlt = post?.title;
        const publishedDate = new Date(post.date || post.publishedAt).toLocaleDateString('pt-BR', {
            day: '2-digit',
            month: 'short'
        });

        return `
            <a href="/blog-review/${post.id}/${slugify(post.title)}" class="recent-post-item">
                ${imageUrl ? `
                    <img src="${imageUrl}" class="recent-post-image" alt="${imageAlt}">
                ` : `
                    <div class="recent-post-image bg-light d-flex align-items-center justify-content-center">
                        <i class="bi bi-image text-muted"></i>
                    </div>
                `}
                <div class="recent-post-content">
                    <h6>${post.title}</h6>
                    <div class="recent-post-date">${publishedDate}</div>
                </div>
            </a>
        `;
    }).join('');

    window.core.setData('recent-posts-list', html);
}

function initEvents() {
    const searchInput = document.getElementById('search-input');
    let searchTimeout;
    searchInput.addEventListener('input', function() {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
            BLOG_CONFIG.searchTerm = this.value;
            renderBlogPosts(filterAndSortPosts());
        }, 300);
    });

    document.getElementById('category-filter').addEventListener('change', function() {
        BLOG_CONFIG.selectedCategory = this.value;
        renderBlogPosts(filterAndSortPosts());
    });

    document.getElementById('sort-filter').addEventListener('change', function() {
        BLOG_CONFIG.sortBy = this.value;
        renderBlogPosts(filterAndSortPosts());
    });

    document.addEventListener('click', function(e) {
        const categoryEl = e.target.closest('.category-item');
        if (categoryEl) {
            e.preventDefault();
            BLOG_CONFIG.selectedCategory = categoryEl.dataset.category;
            document.getElementById('category-filter').value = categoryEl.dataset.category;
            renderBlogPosts(filterAndSortPosts());
        }
    });
}

document.addEventListener('DOMContentLoaded', function() {
    bootstrapBlog();
    initEvents();
});
</script>
 
